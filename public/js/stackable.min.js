/*
 * stackable - v0.0.2
 * Author: Emiliano Prandi
 * http://emiprandi.github.io/stackable
 * MIT License
 */
!function(a){"use strict";var b=function(b,c){this.stacker={e:null,html:'<li class="sa-stacker"><a href="#">'+c.stackerLabel+"</a><ul></ul></li>",width:0},this.e=b,this.navItems={items:{},length:0},this.navWidth=this.containerWidth=0;var d=0,e=0,f=this.navItems.items;this.e.children("li").each(function(){f[d]={html:a(this)[0].outerHTML,width:a(this).outerWidth(!0),submenu:!1,visible:!0,replacedAnchorTag:!1},a(this).hasClass("submenu")&&(f[d].submenu=!0),e+=f[d].width,d++}),this.navItems.length=d,this.navWidth=e,this.stacker.e=a(this.stacker.html).appendTo(this.e),this.stacker.width=this.stacker.e.outerWidth(!0),this.stacker.e.remove(),this.magic()};b.prototype.resetStack=function(){for(var a=0;a<this.navItems.length;a++)this.navItems.items[a].visible=!0},b.prototype.magic=function(){this.resetStack(),this.containerWidth=this.e.parent().width();var a=0,b=0;if(this.containerWidth<this.navWidth)for(b=0;b<this.navItems.length;b++)a+=this.navItems.items[b].width,a+this.stacker.width>this.containerWidth&&(this.navItems.items[b].visible=!1);this.stack()},b.prototype.stack=function(){this.e.empty();var b=!1,c=0;for(c=0;c<this.navItems.length;c++){if(!this.navItems.items[c].visible){b=!0;break}a(this.navItems.items[c].html).appendTo(this.e)}if(b)for(this.stacker.e=a(this.stacker.html).appendTo(this.e),c=0;c<this.navItems.length;c++)if(!this.navItems.items[c].visible){var d=this.navItems.items[c].html;-1!==d.indexOf("<ul>")&&(d=d.replace(/<a[^>]*>/,'<span class="sa-anchor-replacement">').replace(/<\/a>/,"</span>")),a(d).appendTo(this.stacker.e.children("ul")),this.navItems.items[c].visible=!1}},b.prototype.setActions=function(){var b=this.e,c="li.submenu, li.sa-stacker",d="li.submenu>a, li.sa-stacker>a";a(b).on("click.stackable.nav",d,function(){return a(this).parent().hasClass("sa-open")?a(b.selector).children(c).removeClass("sa-open"):(a(b.selector).children(c).removeClass("sa-open"),a(this).parent().toggleClass("sa-open")),!1}),a(document).on("click.stackable.closure",function(){a(b.selector).children(c).removeClass("sa-open")})},a.fn.stackable=function(c){var d={stackerLabel:"+"},e=!1;if(this.each(function(){"UL"!=this.tagName&&(e=!0)}),!e){var f=new b(this,a.extend(d,c));f.setActions(),a(window).resize(function(){f.magic()})}}}(jQuery);